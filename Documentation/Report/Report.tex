%-------------------------------------------------------------------------------
% File:		    Report.tex
% Author:	    Igor Janjic, Danny Duangphachanh, Leah Krynitsky, Brian
%               Hilnbrand
% Description:	[ECE 4534] Network Applications Design
%		        Project proposal.
%%------------------------------------------------------------------------------ 

\input{./Preamble.tex}
\input{./Definitions.tex}
\input{./Programming.tex}

% Make compact sections.
\usepackage[compact]{titlesec}

\begin{document}

\input{./Title.tex}

\subsection{Introduction}

\subsection{Sensors}

This section will provide an overview of the sensors that were integrated into the final rover design this semester.  In the project description document, there were five specific goals outlined that the sensors needed to complete.[1]  These goals were as follows: 

  i.	Configure and control all sensors such that they are accurately sampled at the rate dictated by the team API.[1]
  ii.	In response to I2C queries from the Rover Master PIC, send out reports of sensor data according to the team API.[1]
  iii.	Mount sensors on the rover.[1]
  iv.	Develop power system for sensor system on the rover.[1]
  v.	Implement display on the rover that gives immediate feedback on the functionality of the sensor system.[1]
  
Additionally, the project description documentation outlined the need to detect and traverse ramps during the final demonstration.[1]  Although no parts of this goal were specifically assigned to the sensor role, they were an integral part of our plan to meet this requirement.  So, ramps will also be discussed in this section as they pertain to the sensors.

The main role of the sensors involved the ability to detect objects and provide data that could be used to adjust the path of the rover to avoid obstacles.  After researching various options, infrared distance sensors were selected to perform this operation since they are efficient, accurate, and affordable.  We selected the SHARP GP2Y0A60SZLF analog distance sensor for a few advantages that it had in comparison to other IR sensors.  First, its operating speed was on the higher end of the spectrum relative to the alternative options, so it was able to read and process sensor data more quickly.  It also had a relatively broad range for the supply voltage required to power the sensor, which gave us more flexibility when developing the on-board power system.  Finally, it has a detection range from 10cm â€“ 150 cm, which covers most of the range that would typically require a combination of short, medium, and long range IR sensors.[2]  

Two IR sensors were mounted on each side of the rover and spaced about seven inches apart.  There were two additional sensors for ramp detection that were placed on the front, center of the rover and spaced vertically.  Since the supply voltage needed for the motor encoders was within the range of possible supply voltages for the sensors, we were able to develop one power system for both systems, and create a more efficient design.  We placed two battery packs in parallel to prevent power from dipping below 5 volts and connected the rover master pic to the 5 volt source from the sabretooth motor controller.  This allowed us to use the 3.3 volt output from the rover master PIC (PIC18F46J50) to power the encoders and all of the sensors.  Additionally, each sensor output was connected to an analog input of the ADC on the sensor PIC (PIC18F45J10).  In accordance with our team API, every 350 milliseconds, the sensor data was acquired, converted, and saved to an internal data structure in the program written to process and communicate the sensor data.  This was accomplished using a timer interrupt, and interrupt associated with the ADC, and message queues to create a non-blocking and consistent solution.  

The data from the sensors was required to be sent via I2C to the rover master pic whenever it was requested, so the I2C interface on the sensor pic was initialized as a slave and an interrupt was triggered every time data was requested.  In response to any such query for data, the latest twenty bytes of data (two per sensor) were sent to the rover master pic for further processing.  

At the time of the final demonstration, the sensors were all able to read correct data at desired time intervals, and then successfully save and relay that data to the rover master PIC whenever it was requested.  The front two sensors were also able to distinguish between a wall (consistent data between the two vertically spaced sensors) and a ramp (top sensor produces data that represents an object slightly further away than the data returned from the lower sensors).

Unfortunately, there were also a few shortcomings in the sensor system.  No on rover display of immediate sensor data was implemented.  Since the ARM was able to display this information on the built in LCD with no extra hardware, we chose to alternatively display the information through that interface.  Additionally, we ordered an accelerometer to use in our solution for ramp traversal.  We intended to use the accelerometer to determine when the ramp was being traversed (i.e. rover was tilted on the incline of the ramp), and when the top of the ramp was reached (i.e. rover was no longer tilted or on an incline).  However, as we neared the final demonstration date, we decided not to include the accelerometer in our final demonstration due to our time constraints.  


\subsection{Conclusion}

\end{document}
